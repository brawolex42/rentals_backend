{% load i18n static %}
<!doctype html>
<html lang="{{ request.LANGUAGE_CODE|default:'de' }}" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}Rentals{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'users.css' %}">
  <link rel="icon" href="{% static 'favicon.ico' %}">
  <meta name="google" content="notranslate">
</head>
<body>
  <header style="background:#111827; color:#fff;">
    <div style="max-width:1100px; margin:0 auto; padding:.8rem 1rem; display:flex; align-items:center; gap:1rem; justify-content:space-between;">
      <a href="{% url 'home' %}" style="color:#fff; text-decoration:none; font-weight:700;">Rentals</a>
      <nav style="display:flex; align-items:center; gap:.5rem;">
        {% if request.user.is_authenticated %}
          <a href="{% url 'my_bookings' %}" style="color:#fff; text-decoration:none; padding:.35rem .6rem; border-radius:8px; background:#2563eb;">{% trans "My bookings" %}</a>
          <a href="{% url 'account_dashboard' %}" style="color:#fff; text-decoration:none; padding:.35rem .6rem; border-radius:8px; background:#374151;">{% trans "Account" %}</a>
          <a href="{% url 'logout' %}" style="color:#fff; text-decoration:none; padding:.35rem .6rem; border-radius:8px; background:#dc2626;">{% trans "Logout" %}</a>
        {% else %}
          <a href="{% url 'login_page' %}" style="color:#fff; text-decoration:none; padding:.35rem .6rem; border-radius:8px; background:#2563eb;">{% trans "Sign in" %}</a>
          <a href="{% url 'register_page' %}" style="color:#111827; background:#fff; text-decoration:none; padding:.35rem .6rem; border-radius:8px;">{% trans "Register" %}</a>
        {% endif %}
        <div style="margin-left:.5rem; display:flex; gap:.25rem;">
          <a href="/lang/?language=de&next={{ request.get_full_path|urlencode }}" style="color:#fff; text-decoration:none; padding:.35rem .5rem; border-radius:6px; background:#4b5563;">DE</a>
          <a href="/lang/?language=en&next={{ request.get_full_path|urlencode }}" style="color:#fff; text-decoration:none; padding:.35rem .5rem; border-radius:6px; background:#4b5563;">EN</a>
          <button id="theme-toggle" title="Theme" style="border:0; background:transparent; color:#fff; cursor:pointer; padding:.35rem .5rem; border-radius:6px;">ðŸŒ“</button>
        </div>
      </nav>
    </div>
  </header>

  <main style="max-width:1100px; margin:0 auto; padding:1rem;">
    {% if messages %}
      <div aria-live="polite" style="margin:0 0 1rem; display:grid; gap:.5rem;">
        {% for message in messages %}
          <div style="padding:.6rem .8rem; border-radius:8px; {% if message.level_tag == 'error' %}background:#fee2e2; color:#7f1d1d; border:1px solid #fecaca{% elif message.level_tag == 'success' %}background:#dcfce7; color:#065f46; border:1px solid #bbf7d0{% else %}background:#e5e7eb; color:#111827; border:1px solid #d1d5db{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% block content %}{% endblock %}
  </main>

  <script>
    (function(){
      var root=document.documentElement,key="theme";
      function apply(t){root.setAttribute("data-theme",t==="dark"?"dark":"light");}
      var saved=localStorage.getItem(key);
      if(!saved){saved=(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)?"dark":"light";}
      apply(saved);
      var btn=document.getElementById("theme-toggle");
      if(btn){btn.addEventListener("click",function(){var cur=root.getAttribute("data-theme")==="dark"?"dark":"light";var next=cur==="dark"?"light":"dark";localStorage.setItem(key,next);apply(next);});}
    })();
  </script>
</body>
</html>
